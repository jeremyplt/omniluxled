/*
Generated time: August 7, 2024 11:02
This file was created by the app developer. Feel free to contact the original developer with any questions. It was minified (compressed) by AVADA. AVADA do NOT own this script.
*/
let drawerSelectors={cartIcons:document.querySelectorAll(".header__icon--cart"),cartIconDesktop:document.querySelector("#cart-icon-desktop"),cartIconMobile:document.querySelector("#cart-icon-mobile"),cartDrawerCount:document.querySelector("[data-drawer-cart-count]")};class AjaxCart extends HTMLElement{constructor(){super(),this.openeBy=drawerSelectors.cartIcons,this.isOpen=this.classList.contains("open--drawer"),this.bindEvents(),this.cartNoteInput(),this.querySelectorAll(".close-ajax--cart").forEach(e=>e.addEventListener("click",this.closeCartDrawer.bind(this))),document.querySelectorAll("[data-gwp-close]").forEach(e=>e.addEventListener("click",this.closePopup.bind(this))),document.querySelectorAll("[add-gwp-product]").forEach(e=>e.addEventListener("click",this.addMultiGWPProduct.bind(this))),"cart"!=window.globalVariables.template?(this.addAccessibilityAttributes(this.openeBy),this.getCartData()):this.style.visibility="visible","iPhone"===navigator.platform&&document.documentElement.style.setProperty("--viewport-height",window.innerHeight+"px")}manageQtyInput(e){e=e.currentTarget;e.value<0&&(e.value=Math.abs(e.value)),2<e.value.length&&(e.value=e.value.slice(0,2))}static get observedAttributes(){return["updating"]}attributeChangedCallback(e,t,r){"updating"==e&&"false"==r&&this.updateEvents()}addAccessibilityAttributes(e){let t=this;e.forEach(e=>{e.setAttribute("role","button"),e.setAttribute("aria-expanded",!1),e.setAttribute("aria-controls",t.id)})}onKeyUp(e){"ESCAPE"===e.code.toUpperCase()&&this.querySelector(".close-ajax--cart").dispatchEvent(new Event("click"))}bindEvents(){"cart"!=window.globalVariables.template&&(this.openeBy.forEach(e=>e.addEventListener("click",this.openCartDrawer.bind(this))),this.addEventListener("keyup",this.onKeyUp.bind(this)))}updateEvents(){this.querySelectorAll("[data-itemRemove]").forEach(e=>e.addEventListener("click",this.removeItem.bind(this))),this.querySelectorAll("[data-qty-btn]").forEach(e=>e.addEventListener("click",this.manageQtyBtn.bind(this))),this.querySelectorAll("[data-qty-input]").forEach(e=>e.addEventListener("change",this.onQtyChange.bind(this))),this.querySelectorAll("[data-gwp-multi-tier]").forEach(e=>e.addEventListener("click",this.openPopup.bind(this)))}addEventListenerUpsells(){document.querySelectorAll(".cart-upsell").forEach(e=>{var t=e.querySelector(".cart-upsell-form");let r=e.getAttribute("data-products-remove").split(",");""===r[r.length-1]&&r.pop(),t.addEventListener("submit",e=>{r.forEach(e=>{setTimeout(()=>{fetch("/cart/change.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,quantity:0})}).then(e=>{e.ok&&this.getCartData()})},500)})})})}renderUpsells(){fetch(window.Shopify.routes.root+"?section_id=cart-drawer").then(e=>e.text()).then(e=>{var e=(new DOMParser).parseFromString(e,"text/html"),t=e.querySelector(".swiper-container.upsell-slider .swiper-wrapper"),r=document.querySelector(".swiper-container.upsell-slider .swiper-wrapper"),e=e.querySelector(".cart-upsell-title");document.querySelector(".cart-upsell-title").innerHTML=e.innerHTML,r.innerHTML=t.innerHTML,0==t.children.length?document.querySelector(".cart-upsell-title").style.display="none":document.querySelector(".cart-upsell-title").style.display="block",this.addEventListenerUpsells()}).catch(e=>console.error(e))}openCartDrawer(e){var t;window.globalVariables.cart_drawer?(document.querySelector("#mobile-menu-drawer").classList.contains("opened-drawer")&&document.querySelector(".close-mobile--navbar").dispatchEvent(new Event("click")),this.classList.add("opened-drawer"),siteOverlay.prototype.showOverlay(),Utility.forceFocus(this.querySelector(".cart-title")),t=this.querySelector(".close-ajax--cart"),Utility.trapFocus(this,t),this.renderUpsells(),e&&(e.preventDefault(),e.currentTarget.setAttribute("aria-expanded",!0)),document.dispatchEvent(new Event("cart-drawer:open"))):window.location.href=window.routes.cart_fetch_url||"/cart"}closeCartDrawer(t,r=!1){if(void 0!==t){t.preventDefault(),this.classList.remove("opened-drawer"),siteOverlay.prototype.hideOverlay(),t.currentTarget.setAttribute("aria-expanded",!1),Utility.removeTrapFocus(r);let e=drawerSelectors.cartIconDesktop;window.innerWidth<1024&&(e=drawerSelectors.cartIconMobile),Utility.forceFocus(e)}}openPopup(e){var t=e.target.getAttribute("data-gwp-multi-tier");document.getElementById(t).querySelector(".modal").classList.add("open"),e.currentTarget.hasAttribute("data-drawer-popup")||siteOverlay.prototype.showOverlay(),document.querySelector("body").classList.add("gwp-tier-open")}closePopup(e){e.target.closest(".modal").classList.remove("open"),e.currentTarget.hasAttribute("data-drawer-popup")||siteOverlay.prototype.hideOverlay(),document.querySelector("body").classList.remove("gwp-tier-open")}calculatePriceWithTaxes(e,t){var r=window.taxData;return r[t]?e*(1+r[t]):e}_updateCart(e,t){let r="";null!=(r="cart"!=window.globalVariables.template?e["template-cart-drawer"]:e["template-cart"])&&(e=new DOMParser,null!=(e=(r=e.parseFromString(r,"text/html")).querySelector("[data-cartScriptJSON]"))&&(window.globalVariables.cart=JSON.parse(e.textContent)),e=r.querySelector("ajax-cart form"),this.querySelector("form").innerHTML=e.innerHTML,this.querySelector("[data-carttotal]").innerHTML=Shopify.formatMoney(this.calculatePriceWithTaxes(window.globalVariables.cart.total_price,window.customerCountry),window.globalVariables.money_format),e=this.querySelectorAll("[data-checkoutBtns], [data-cartnote], [data-cartupsell]"),window.globalVariables.cart.item_count<=0?(e.forEach(e=>{e.classList.add("d-none")}),document.querySelector("[data-upsell-product]")&&document.querySelector("[data-upsell-product]").classList.add("d-none"),drawerSelectors.cartDrawerCount.innerHTML="0"):(e.forEach(e=>{e.classList.remove("d-none")}),document.querySelector("[data-upsell-product]")&&document.querySelector("[data-upsell-product]").classList.remove("d-none")),this.setAttribute("updating",!1),e=r.querySelector("[data-drawer-cart-count]").innerHTML,drawerSelectors.cartIconDesktop.querySelector(".cart-count")&&(drawerSelectors.cartIconDesktop.querySelector(".cart-count").innerHTML=e),drawerSelectors.cartIconMobile.querySelector(".cart-count")&&(drawerSelectors.cartIconMobile.querySelector(".cart-count").innerHTML=e),0<window.globalVariables.cart.item_count&&drawerSelectors.cartDrawerCount.querySelector(".cart-count")&&(drawerSelectors.cartDrawerCount.querySelector(".cart-count").innerHTML=e),drawerSelectors.cartDrawerCount.innerHTML=e,this.qtyInputs=this.querySelectorAll("input[data-qty-input]"),this.qtyInputs.forEach(e=>{e.addEventListener("keyup",this.manageQtyInput.bind(this))}),window.globalVariables.cart_drawer&&"open_drawer"==t&&"cart"!=window.globalVariables.template&&this.openCartDrawer(),window.setTimeout(function(){window.dispatchEvent(new Event("refreshAjaxCart")),window.dispatchEvent(new Event("refreshAjaxSideCart"))},500))}addGWPProduct(e,t){var r;"gwpc"==t?r={id:parseInt(e),quantity:1,properties:{product_type:"gwpc",free_product:"true"}}:"gwpp"==t?r={id:parseInt(e),quantity:1,properties:{product_type:"gwpp",free_product:"true"}}:"tier1"==t&&(r={id:parseInt(e),quantity:1,properties:{product_type:"tier1",free_product:"true"}}),fetch("/cart/add.json",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(r)}).then(e=>{document.querySelector("ajax-cart").getCartData()})}addMultiGWPProduct(e){e.preventDefault(),e.stopPropagation();let t=e.currentTarget;var r,e=t.getAttribute("add-gwp-product")||null,a=t.closest(".modal").querySelector(".close-popup"),o=t.getAttribute("data-gwp-type"),n=(t.classList.add("loading"),t.closest(".modal").querySelectorAll("[add-gwp-product]"));n.forEach(e=>e.classList.add("disable-element")),"tier1"==o&&(r={id:parseInt(e),quantity:1,properties:{product_type:"tier1",free_product:"true"}}),fetch("/cart/add.json",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(r)}).then(e=>{n.forEach(e=>e.classList.remove("disable-element")),t.classList.remove("loading"),a.click(),document.querySelector("ajax-cart").getCartData()})}removeSampleProducts(e){var t=e.split(","),r={};for(let e=0;e<t.length;++e)r[t[e]]=0,e==t.length-1&&fetch("/cart/update.json",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({updates:r})}).then(e=>{document.querySelector("ajax-cart").getCartData()})}getCartData(t){let e=routes.cart_fetch_url+"?sections=template-cart";"cart"!=window.globalVariables.template&&(e=routes.cart_fetch_url+"?sections=template-cart-drawer"),this.checkGiftWithPurchase(),fetch(e).then(e=>e.json()).then(e=>{this._updateCart(e,t)}).catch(e=>{console.error(e)}).finally(()=>{})}checkGiftWithPurchase(){var a,o;window.theme.giftWithPurchase.enabled&&(o=a=!1,fetch("/cart.json").then(e=>{if(200!==e.status)throw new Error(`refreshCart function failed to get request, Shopify returned ${e.status} `+e.statusText);e.json().then(e=>{e.items&&(e.items.forEach((e,t)=>{var r=e.handle;if(1!=e.properties.free_gift)return-1!==window.theme.giftWithPurchase.eligigleProducts.indexOf("|"+r+"|")?(o=!0,0):void 0;1<e.quantity&&this.updateItemQty(e.key,1),a=!0}),o&&!a&&window.theme.giftWithPurchase.giftProductID&&this.addFreeProduct(window.theme.giftWithPurchase.giftProductID),!o)&&a&&window.theme.giftWithPurchase.giftProductID&&this.removeFreeProduct(window.theme.giftWithPurchase.giftProductID),0==e.item_count?(sessionStorage.removeItem("gwpRemoved"),document.querySelectorAll("ajax-cart").forEach(e=>{e.classList.add("empty-cart")})):document.querySelectorAll("ajax-cart").forEach(e=>{e.classList.remove("empty-cart")})})}).catch(e=>{console.error(e)}).finally(()=>{}))}addFreeProduct(e){sessionStorage.getItem("gwpRemoved")||getFromSessionStorage(gwpLocalCheck)||(setInSessionStorage(gwpLocalCheck,"true"),fetch("/cart/add.js",{body:JSON.stringify({id:e,quantity:1,properties:{free_gift:!0}}),credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"xmlhttprequest"},method:"POST"}).then(function(e){return e.json()}).then(function(e){removeFromSessionStorage(gwpLocalCheck),document.querySelector("ajax-cart").getCartData()}).catch(function(e){console.error(e),removeFromSessionStorage(gwpLocalCheck)}))}removeFreeProduct(e){fetch("/cart/change.js",{body:JSON.stringify({id:e,quantity:0,properties:{free_gift:!0}}),credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"xmlhttprequest"},method:"POST"}).then(function(e){return e.json()}).then(function(e){removeFromSessionStorage(gwpLocalCheck),document.querySelector("ajax-cart").getCartData()}).catch(function(e){console.error(e),removeFromSessionStorage(gwpLocalCheck)})}updateItemQty(e,t){let r=document.querySelector(`[data-cart-item="${e}"]`);r&&r.classList.add("updating");var a={};a[e]=t,a=JSON.stringify({updates:a}),fetch(""+routes.cart_update_url,{...fetchConfig(),body:a}).then(e=>e.text()).then(e=>{this.getCartData(),setTimeout(()=>{r&&r.classList.remove("updating")},1e3)}).catch(e=>{setTimeout(()=>{r&&r.classList.remove("updating")},1e3),console.log(e)})}removeItem(e){e.preventDefault();var e=e.currentTarget,t=e.dataset.index||null;e.classList.contains("free-gift-with-purchase")&&window.sessionStorage.setItem("gwpRemoved","true"),null!=t&&this.updateItemQty(t,0)}manageQtyBtn(e){e.preventDefault();var e=e.currentTarget,t=e.dataset.for||"increase",e=e.closest("[data-qty-container]").querySelector("[data-qty-input]"),r=e.dataset.index||1,e=parseInt(e.value)||1;let a=1;if("decrease"==t&&e<=1)return!1;a="decrease"==t?e-1:e+1,this.updateItemQty(r,a)}onQtyChange(e){var e=e.currentTarget,t=e.value,e=e.dataset.index||null;e&&this.updateItemQty(e,t)}cartNoteInput(){let r=document.querySelector('[data-cartNote] [name="note"]');if(r){let t=document.querySelector("[data-saveNote]");["input","paste"].forEach(e=>{r.addEventListener(e,()=>{r.dataset.default!=r.value?t.style.display="block":t.style.display="none"},!1)}),t.addEventListener("click",e=>{e.preventDefault();var t,r,e=e.currentTarget.closest("[data-cartNote]");e.querySelector('[name="note"]').value.trim().length<=0?alert("Add Note before proceeding"):(r=(t=e.querySelector("[data-saveNote]")).dataset.adding_txt||"Saving...",t.innerHTML=r,t.disabled=!0,this.updateCartNote(e))})}}updateCartNote(e){let t=this,r=e.querySelector('[name="note"]'),a=r.value.trim(),o=e.querySelector("[data-resultMsg]"),n=e.querySelector("[data-saveNote]"),i=n.dataset.default||"Save";e=JSON.stringify({note:a});fetch(""+routes.cart_update_url,{...fetchConfig(),body:e}).then(function(e){200==e.status?(o&&(o.innerText="Added note to Order!",t.manageResponseText(o)),r&&(r.dataset.default=a),n.style.display="none"):(console.error("Request returned an error",e),o&&(o.innerText=e,t.manageResponseText(o))),n.innerHTML=i,n.disabled=!1}).catch(function(e){console.error("Request failed",e),o&&(o.innerText=e,t.manageResponseText(o)),n.innerHTML=i,n.disabled=!1})}manageResponseText(e){Utility.fadeEffect(e,"fadeIn"),setTimeout(()=>{Utility.fadeEffect(e,"fadeOut")},3e3)}}customElements.define("ajax-cart",AjaxCart);let gwpLocalCheck="gwpAttemptAdd";function getFromSessionStorage(t){try{return sessionStorage.getItem(t)}catch(e){console.error("Could not get item from storage with key",t,e)}}function setInSessionStorage(t,r){try{sessionStorage.setItem(t.toString(),r.toString())}catch(e){console.error("Could not set item in storage with key, value",t,r,e)}}function removeFromSessionStorage(t){try{sessionStorage.removeItem(t)}catch(e){console.error("Could not remove item from storage with key",t,e)}}function initAll(){document.querySelectorAll(".cart-item").forEach(e=>{e.dataset.itemId;var t=e.querySelector(".upsell__checkbox"),r=e.querySelector(".upsell__options");t&&r&&!e.dataset.listenerAdded&&(t.addEventListener("change",handleCheckboxChange.bind(null,t,r)),r.addEventListener("change",handleOptionsChange.bind(null,t,r)),e.dataset.listenerAdded=!0)})}async function handleCheckboxChange(e,t){var r=e.dataset.variantId;showOverlay(),e.checked?(t.style.display="block",await addOrUpdateSellingPlan(r,t.options[0].value)):(t.style.display="none",await removeSellingPlan(r,t.value)),document.querySelector("ajax-cart").getCartData(),setTimeout(()=>{hideOverlay()},1e3)}async function handleOptionsChange(e,t){var r=e.dataset.variantId;e.checked&&(showOverlay(),await addOrUpdateSellingPlan(r,t.value),document.querySelector("ajax-cart").getCartData(),setTimeout(()=>{hideOverlay()},1e3))}async function addOrUpdateSellingPlan(e,t){var r=await getCart(),a=findLineItemWithPlan(r,e),r=findLineItemWithoutPlan(r,e);let o;e=await addLineItemPlan(e,t,o=r?r.quantity:a?a.quantity:1);return a&&await removeLineItem(a.key),r&&await removeLineItem(r.key),e}async function removeSellingPlan(e,t){var r=findLineItemWithPlan(await getCart(),e);r&&(await removeLineItem(r.key),await addLineItem(e,r.quantity))}async function getCart(){var e=await fetch("/cart.json");if(200===e.status)return e.json();throw new Error(`Failed to get request, Shopify returned ${e.status} `+e.statusText)}function findLineItemWithPlan(e,t){return e.items.find(e=>e.id===parseInt(t)&&e.selling_plan_allocation)}function findLineItemWithoutPlan(e,t){return e.items.find(e=>e.id===parseInt(t)&&!e.selling_plan_allocation)}function removeLineItem(e){return postToShopify("cart/change.js",{id:e,quantity:0})}function addLineItemPlan(e,t,r){return postToShopify("cart/add.js",{items:[{quantity:r,id:e,selling_plan:t}]})}function addLineItem(e,t){return postToShopify("cart/add.js",{items:[{quantity:t,id:e}]})}function postToShopify(e,t){return fetch(window.Shopify.routes.root+e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>{if(e.ok)return e.json();throw new Error(e.statusText)}).then(e=>(console.log("Response:",e),e)).catch(e=>{console.error("Error:",e)})}function showOverlay(){document.getElementById("cart-overlay").style.display="flex"}function hideOverlay(){document.getElementById("cart-overlay").style.display="none"}document.addEventListener("DOMContentLoaded",initAll),window.addEventListener("refreshAjaxCart",initAll);