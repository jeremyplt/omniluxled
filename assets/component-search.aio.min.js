/*
Generated time: August 7, 2024 11:02
This file was created by the app developer. Feel free to contact the original developer with any questions. It was minified (compressed) by AVADA. AVADA do NOT own this script.
*/
class SearchModal extends HTMLElement{constructor(){super();let t=this;this.openSearchModal=document.querySelectorAll(".open-searchform"),this.searchFormContainer=this.querySelector(".searchform"),this.searchresults=this.querySelector(".predictive-search"),this.searchQuery=this.querySelector('form[action="/search"] [name="q"]'),this.searchFormContainer.addEventListener("keyup",e=>{"ESCAPE"===e.code.toUpperCase()&&this.close()}),this.openSearchModal.forEach(e=>{e.addEventListener("click",function(e){t.onToggleBtnClick(e)}),e.setAttribute("role","button"),e.setAttribute("aria-expanded","false")}),this.querySelector(".search-modal__close-button")&&this.querySelector(".search-modal__close-button").addEventListener("click",this.close.bind(this)),this.typingTimer,this.searchQuery&&(this.searchQuery.addEventListener("input",this.queryInput.bind(this)),this.searchQuery.addEventListener("keydown",()=>{clearTimeout(this.typingTimer)}))}isOpen(){return this.searchFormContainer.hasAttribute("open")}onToggleBtnClick(e){e.preventDefault(),e.stopPropagation(),this.searchFormContainer.hasAttribute("open")?this.close():this.open(e)}onBodyClick(e){}queryInput(e){let t=this;let r=e.currentTarget.value.trim();clearTimeout(t.typingTimer),t.typingTimer=setTimeout(function(){t._queryChange(r)},1e3)}_queryChange(r){if(!(r.length<=0||null==r)){let t=this.searchFormContainer.querySelector('[name="type"]').value;fetch(`${routes.predictive_searh}?q=${r}&resources[type]=${t}&resources[options][unavailable_products]=last`).then(e=>e.json()).then(e=>{e=e.resources.results;let s="";0<e.products.length?(e.products.forEach(t=>{if(1!=t.tags.includes("free-product")){var r=Shopify.formatMoney(100*t.price,window.globalVariables.money_format);let e=t.image;null!=t.image&&""!=t.image||(e=window.globalVariables.no_image),7991999987874!=t.id&&8314329661602!=t.id&&(t=`<div class="col-sm-6 p-2"><div class="border h-100"><div class="predictive-search-product align-items-center mx-n2 row h-100">
                    <div class="col-3 px-2">
                        <a href="${t.url}"><img src="${e}" alt="${t.title}"></a>
                    </div>
                    <div class="col-9 p-2 pe-3">
                        <p class="product-title mb-2"><a href="${t.url}" class="product-title">${t.title}</a></p>
                        <p class="product-price mb-0">${r}</p>
                    </div>
                </div></div></div>`,s+=t)}}),this.searchresults&&(this.searchresults.querySelector(".predictive-search-product-list").innerHTML=s,this.searchresults.querySelector(".predictive-search-footer a").href=`/search?q=${r}&resources[type]=`+t,this.searchresults.style.display="block")):this.searchresults&&(this.searchresults.querySelector(".predictive-search-product-list").innerHTML="",this.searchresults.style.display="none")}).catch(e=>{console.error(e)}).finally(()=>{})}}open(e){this.onBodyClickEvent=this.onBodyClickEvent||this.onBodyClick.bind(this),this.searchFormContainer.setAttribute("open",!0),this.searchFormContainer.removeAttribute("aria-hidden"),this.classList.add("open__modal"),this.removeAttribute("style"),document.body.addEventListener("click",this.onBodyClickEvent),Utility.trapFocus(this),Utility.forceFocus(document.querySelector("[data-search-input]"))}close(e=0){Utility.removeTrapFocus(),this.searchFormContainer.removeAttribute("open"),this.searchFormContainer.setAttribute("aria-hidden",!0),this.classList.remove("open__modal"),siteOverlay.prototype.hideOverlay(),document.body.removeEventListener("click",this.onBodyClickEvent),this.searchresults&&(this.searchresults.querySelector(".predictive-search-product-list").innerHTML="",this.searchresults.style.display="none")}}customElements.define("search-modal",SearchModal);