/*
Generated time: August 7, 2024 11:02
This file was created by the app developer. Feel free to contact the original developer with any questions. It was minified (compressed) by AVADA. AVADA do NOT own this script.
*/
class ProductForm extends HTMLElement{constructor(){super(),this.form=this.querySelector("form"),this.form&&this.form.addEventListener("submit",this.onSubmitHandler.bind(this)),this.cartElement=document.querySelector("ajax-cart"),this.qtyInputs=this.querySelectorAll('[data-qty-input][name="quantity"]'),this.qtyInputs.forEach(t=>t.addEventListener("keyup",this.manageQtyInput.bind(this))),this.qtyBtns=this.querySelectorAll("[data-qty-btn]"),this.qtyBtns.forEach(t=>t.addEventListener("click",this.manageQtyBtn.bind(this)))}manageQtyInput(t){t=t.currentTarget;t.value<0&&(t.value=Math.abs(t.value)),2<t.value.length&&(t.value=t.value.slice(0,2))}onSubmitHandler(t){t.preventDefault();let e=[],r=this.querySelector('[type="submit"]'),a=this.querySelector("[data-qty-input]");t=this.closest(".product-details-wrapper"),r.setAttribute("disabled",!0),r.classList.add("loading"),e.push(JSON.parse(serializeForm(this.form))),t&&t.querySelectorAll("[data-addon-selection]:checked").forEach(t=>{t.disabled||(t={id:(t=t.closest("addons-form")).querySelector(".variant--id").value,quantity:t.querySelector(".product-quantity").value},e.push(t))}),t=JSON.stringify({items:e});fetch(""+routes.cart_add_url,{...fetchConfig(),body:t}).then(t=>t.json()).then(()=>{document.querySelector("#PopupModal-quickshop")&&document.querySelector("#PopupModal-quickshop .close-quickshop").dispatchEvent(new Event("click")),this.cartElement.getCartData("open_drawer"),a&&(a.value=1)}).catch(t=>{console.error(t)}).finally(()=>{r.classList.remove("loading"),r.removeAttribute("disabled")})}manageQtyBtn(t){t.preventDefault();var t=t.currentTarget,e=t.dataset.for||"increase",t=t.closest("[data-qty-container]").querySelector("[data-qty-input]"),r=parseInt(t.value)||1;let a=1;if("decrease"==e&&r<=1)return!1;a="decrease"==e?r-1:r+1,t.value=a}}customElements.define("product-form",ProductForm);class VariantSelects extends HTMLElement{constructor(){super(),this.form=this.closest("form")||this.closest(".form-element"),this.formType=this.form.dataset.format,this.addBtn=this.form.querySelector('[name="add"]'),this.variant_json=this.form.querySelector("[data-variantJSON]"),this.variantPicker=this.dataset.type,"product-page"==this.formType&&this.onVariantChange("load"),this.addEventListener("change",this.onVariantChange.bind(this))}onVariantChange(t){var e;this.setCurrentVariant(),"product-page"==this.formType&&(window.globalVariables.product.currentVariant=this.currentVariant),this.currentVariant?("grid"==this.formType?(e=this.closest("[data-product-grid]"),this.renderProductInfo(this.currentVariant,e),this._updateLinks(e)):(e=this.closest("[data-product-container]"),this.renderProductInfo(this.currentVariant,e)),this.updateURLandID(this.currentVariant),this.toggleAddButton("enable"),(e=document.querySelector("skio-plan-picker"))&&(e.selectedVariant=this.currentVariant)):(this.toggleAddButton("disable"),this.form.querySelectorAll("[data-optionindex]").forEach(t=>{var e="option"+t.dataset.optionindex,r=t.querySelector('input[type="radio"]:checked'),t=t.querySelector(".selected-option");t&&e&&r&&(t.innerHTML=r.value)}))}_updateLinks(t){if(this.currentVariant&&t){let r="?variant="+this.currentVariant.id;t.querySelectorAll(".product-link").forEach(t=>{var e=t.href.split("?")[0];t.href=e+r})}}_getOptionsFromSelect(){let e=[];return this.querySelectorAll(".variant_selector").forEach(t=>{e.push(t.value)}),e}_getOptionsFromRadio(){return Array.from(this.querySelectorAll("fieldset:not(.addon-fieldset)")).map(t=>Array.from(t.querySelectorAll("input:not(.addon-swatch)")).find(t=>t.checked).value)}setCurrentVariant(){this.currentVariant=!1;let r="variant-select"==this.variantPicker?this._getOptionsFromSelect():this._getOptionsFromRadio();this._getVariantData().find(t=>{t.options.map((t,e)=>r[e]===t).includes(!1)||(this.currentVariant=t)})}updateURLandID(t){t&&("product-page"==this.formType&&window.history.replaceState({},"",this.dataset.url+"?variant="+t.id),this.form.querySelector('input[name="id"]').value=t.id)}calculatePriceWithTaxes(t,e){var r=window.taxData;return r[e]?t*(1+r[e]):t}renderProductInfo(r,t){if(r&&t){var e=window.customerCountry,a=Shopify.formatMoney(this.calculatePriceWithTaxes(r.price,e),window.globalVariables.money_format),e=Shopify.formatMoney(this.calculatePriceWithTaxes(r.compare_at_price,e),window.globalVariables.money_format),i=t.querySelector("[data-currentPrice]"),o=t.querySelector("[data-comparePrice]");if(console.log("price",a),console.log("compare_price",e),console.log("priceElement",i),console.log("comparePriceElement",o),i&&(i.innerHTML=a),o&&(o.innerHTML=e,r.compare_at_price<=0?o.style.display="none":o.style.display="block"),"grid"==this.formType){if(!r.featured_image)return;i=t.querySelector("[data-feauredImage]"),a=r.featured_image.src;a&&(i.src=a,i.srcset=a)}else{if(!r.featured_image)return;e=r.featured_media.id;let t=document.querySelector(`.product--media[data-mediaID="${e}"]`);if(!(t="quickshop"==this.formType?document.querySelector(`.quickshop-slider .product--media[data-mediaID="${e}"]`):t))return;o=Array.from(t.parentNode.children).indexOf(t);quickShopSlider?quickShopSlider.slideTo(o,2e3,!0):productSlider&&productSlider.slideTo(o,2e3,!0)}this.form.querySelectorAll("[data-optionindex]").forEach(t=>{var e="option"+t.dataset.optionindex,t=t.querySelector(".selected-option");t&&e&&(t.innerHTML=r[e])})}}toggleAddButton(t){this.addBtn&&(console.log("we are here first"),"disable"==t?(this.addBtn.setAttribute("disabled",!0),this.addBtn.querySelector(".add-text")&&(this.addBtn.querySelector(".add-text").textContent=window.variantStrings.unavailable)):this.currentVariant&&!this.currentVariant.available?(this.addBtn.setAttribute("disabled",!0),this.addBtn.querySelector(".add-text")&&(this.addBtn.querySelector(".add-text").textContent=window.variantStrings.soldOut)):(this.addBtn.removeAttribute("disabled"),this.form.classList.contains("cart-upsell-form")?(console.log("we are here"),this.addBtn.querySelector(".add-text").textContent=window.variantStrings.upsellAddText):this.addBtn.querySelector(".add-text").textContent=window.variantStrings.addToCart))}_getVariantData(){return this.variantData=this.variantData||JSON.parse(this.variant_json.textContent),this.variantData}}customElements.define("variant-selects",VariantSelects);class VariantRadios extends VariantSelects{constructor(){super(),this.form=this.closest("form")||this.querySelector(".form-element"),this.formType=this.form.dataset.format;var t=this.querySelector(".color-swatch");t&&t.querySelectorAll(".swatch").forEach(t=>{var e=t.querySelector('input[type="radio"]').dataset.handle,e=Utility.getSwatchStyle(e);t.querySelector(".swatch-label").setAttribute("style",e)})}}customElements.define("variant-radios",VariantRadios);